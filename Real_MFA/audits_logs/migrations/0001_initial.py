# Generated by Django 4.2 on 2026-01-06 09:29

from django.conf import settings
from django.db import migrations, models
import django.db.models.deletion
import uuid


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
        ('devices', '0001_initial'),
        ('sessions', '0001_initial'),
    ]

    operations = [
        migrations.CreateModel(
            name='SessionDeviceLinkAuditLog',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('ip_address', models.GenericIPAddressField()),
                ('user_agent', models.TextField(blank=True)),
                ('referer', models.URLField(blank=True)),
                ('description', models.TextField()),
                ('status', models.CharField(choices=[('success', 'Success'), ('failed', 'Failed'), ('pending', 'Pending')], db_index=True, default='success', max_length=20)),
                ('metadata', models.JSONField(blank=True, default=dict)),
                ('action', models.CharField(choices=[('device_added_to_session', 'Device Added to Session'), ('device_removed_from_session', 'Device Removed from Session'), ('device_changed_mid_session', 'Device Changed Mid-Session'), ('device_verified_for_session', 'Device Verified for Session'), ('device_unverified_for_session', 'Device Unverified for Session'), ('session_device_sync', 'Session-Device Sync')], max_length=50)),
                ('device_was_verified', models.BooleanField(default=False)),
                ('device_now_verified', models.BooleanField(default=False)),
                ('device_was_trusted', models.BooleanField(default=False)),
                ('device_now_trusted', models.BooleanField(default=False)),
                ('link_duration_seconds', models.PositiveIntegerField(blank=True, null=True)),
                ('changed_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_made', to=settings.AUTH_USER_MODEL)),
                ('device', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='session_link_audits', to='devices.device')),
                ('previous_device', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='previous_device_links', to='devices.device')),
                ('session', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='device_link_audits', to='sessions.session')),
                ('user', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_logs', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Session-Device Link Audit Log',
                'verbose_name_plural': 'Session-Device Link Audit Logs',
                'db_table': 'session_device_link_audit_logs',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='SessionAuditLog',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('ip_address', models.GenericIPAddressField()),
                ('user_agent', models.TextField(blank=True)),
                ('referer', models.URLField(blank=True)),
                ('description', models.TextField()),
                ('status', models.CharField(choices=[('success', 'Success'), ('failed', 'Failed'), ('pending', 'Pending')], db_index=True, default='success', max_length=20)),
                ('metadata', models.JSONField(blank=True, default=dict)),
                ('action', models.CharField(choices=[('session_created', 'Session Created'), ('session_renewed', 'Session Renewed'), ('session_activity', 'Session Activity'), ('session_revoked', 'Session Revoked'), ('session_expired', 'Session Expired'), ('session_terminated', 'Session Terminated'), ('access_token_issued', 'Access Token Issued'), ('access_token_refreshed', 'Access Token Refreshed'), ('refresh_token_issued', 'Refresh Token Issued'), ('refresh_token_used', 'Refresh Token Used'), ('refresh_token_rotated', 'Refresh Token Rotated'), ('token_blacklisted', 'Token Blacklisted'), ('session_hijack_detected', 'Session Hijack Detected'), ('concurrent_session_limit_exceeded', 'Concurrent Session Limit Exceeded'), ('suspicious_activity_detected', 'Suspicious Activity Detected'), ('device_linked_to_session', 'Device Linked'), ('device_changed_during_session', 'Device Changed'), ('device_unverified', 'Device Unverified')], max_length=50)),
                ('session_jti', models.CharField(db_index=True, max_length=255)),
                ('previous_ip', models.GenericIPAddressField(blank=True, null=True)),
                ('previous_user_agent', models.TextField(blank=True)),
                ('token_type', models.CharField(blank=True, choices=[('access', 'Access Token'), ('refresh', 'Refresh Token'), ('both', 'Both')], max_length=20)),
                ('token_jti', models.CharField(blank=True, db_index=True, max_length=255)),
                ('session_duration_seconds', models.PositiveIntegerField(blank=True, null=True)),
                ('risk_level', models.CharField(choices=[('low', 'Low'), ('medium', 'Medium'), ('high', 'High'), ('critical', 'Critical')], default='low', max_length=20)),
                ('action_taken', models.CharField(blank=True, max_length=255)),
                ('requires_review', models.BooleanField(default=False)),
                ('changed_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_made', to=settings.AUTH_USER_MODEL)),
                ('device', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='session_audits', to='devices.device')),
                ('session', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='audit_logs', to='sessions.session')),
                ('user', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_logs', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Session Audit Log',
                'verbose_name_plural': 'Session Audit Logs',
                'db_table': 'session_audit_logs',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='MFAChangeLog',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('change_type', models.CharField(choices=[('method_enabled', 'Method Enabled'), ('method_disabled', 'Method Disabled'), ('primary_method_changed', 'Primary Method Changed'), ('backup_method_added', 'Backup Method Added'), ('backup_method_removed', 'Backup Method Removed'), ('settings_updated', 'Settings Updated'), ('mfa_enforced', 'MFA Enforced'), ('mfa_disabled', 'MFA Disabled'), ('recovery_codes_generated', 'Recovery Codes Generated'), ('recovery_codes_regenerated', 'Recovery Codes Regenerated')], db_index=True, max_length=50)),
                ('description', models.TextField()),
                ('method', models.CharField(blank=True, choices=[('totp', 'TOTP'), ('email', 'Email'), ('sms', 'SMS')], max_length=20, null=True)),
                ('ip_address', models.GenericIPAddressField()),
                ('user_agent', models.TextField(blank=True)),
                ('old_value', models.JSONField(blank=True, null=True)),
                ('new_value', models.JSONField(blank=True, null=True)),
                ('reason', models.TextField(blank=True)),
                ('requires_approval', models.BooleanField(default=False)),
                ('is_approved', models.BooleanField(default=True)),
                ('changed_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='mfa_changes_made', to=settings.AUTH_USER_MODEL)),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='mfa_change_logs', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'MFA Change Log',
                'verbose_name_plural': 'MFA Change Logs',
                'db_table': 'mfa_change_logs',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='MFAAuditLog',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('ip_address', models.GenericIPAddressField()),
                ('user_agent', models.TextField(blank=True)),
                ('referer', models.URLField(blank=True)),
                ('description', models.TextField()),
                ('status', models.CharField(choices=[('success', 'Success'), ('failed', 'Failed'), ('pending', 'Pending')], db_index=True, default='success', max_length=20)),
                ('metadata', models.JSONField(blank=True, default=dict)),
                ('action', models.CharField(choices=[('mfa_enabled', 'MFA Enabled'), ('mfa_disabled', 'MFA Disabled'), ('mfa_method_added', 'MFA Method Added'), ('mfa_method_removed', 'MFA Method Removed'), ('mfa_primary_method_changed', 'Primary Method Changed'), ('totp_setup_initiated', 'TOTP Setup Initiated'), ('totp_setup_completed', 'TOTP Setup Completed'), ('totp_verified', 'TOTP Verified'), ('totp_disabled', 'TOTP Disabled'), ('email_mfa_setup_initiated', 'Email MFA Setup Initiated'), ('email_mfa_verified', 'Email MFA Verified'), ('email_mfa_disabled', 'Email MFA Disabled'), ('sms_mfa_setup_initiated', 'SMS MFA Setup Initiated'), ('sms_mfa_verified', 'SMS MFA Verified'), ('sms_mfa_disabled', 'SMS MFA Disabled'), ('backup_codes_generated', 'Backup Codes Generated'), ('backup_codes_regenerated', 'Backup Codes Regenerated'), ('backup_code_used', 'Backup Code Used'), ('mfa_challenge_issued', 'MFA Challenge Issued'), ('mfa_challenge_passed', 'MFA Challenge Passed'), ('mfa_challenge_failed', 'MFA Challenge Failed'), ('mfa_challenge_expired', 'MFA Challenge Expired'), ('mfa_recovery_initiated', 'MFA Recovery Initiated'), ('mfa_recovery_completed', 'MFA Recovery Completed')], max_length=50)),
                ('mfa_method', models.CharField(choices=[('totp', 'TOTP'), ('email', 'Email'), ('sms', 'SMS'), ('backup', 'Backup Code')], db_index=True, max_length=20)),
                ('old_method', models.CharField(blank=True, max_length=20)),
                ('new_method', models.CharField(blank=True, max_length=20)),
                ('challenge_id', models.CharField(blank=True, max_length=255)),
                ('was_verified', models.BooleanField(blank=True, null=True)),
                ('otp_hash', models.CharField(blank=True, max_length=255)),
                ('verification_attempts', models.PositiveIntegerField(default=0)),
                ('recovery_method', models.CharField(blank=True, choices=[('backup_code', 'Backup Code'), ('email_recovery', 'Email Recovery'), ('sms_recovery', 'SMS Recovery'), ('support_recovery', 'Support Recovery')], max_length=50)),
                ('risk_level', models.CharField(choices=[('low', 'Low'), ('medium', 'Medium'), ('high', 'High'), ('critical', 'Critical')], default='low', max_length=20)),
                ('changed_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_made', to=settings.AUTH_USER_MODEL)),
                ('device', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='mfa_audits', to='devices.device')),
                ('user', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_logs', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'MFA Audit Log',
                'verbose_name_plural': 'MFA Audit Logs',
                'db_table': 'mfa_audit_logs',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='DeviceAuditLog',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('ip_address', models.GenericIPAddressField()),
                ('user_agent', models.TextField(blank=True)),
                ('referer', models.URLField(blank=True)),
                ('description', models.TextField()),
                ('status', models.CharField(choices=[('success', 'Success'), ('failed', 'Failed'), ('pending', 'Pending')], db_index=True, default='success', max_length=20)),
                ('metadata', models.JSONField(blank=True, default=dict)),
                ('action', models.CharField(choices=[('device_registered', 'Device Registered'), ('device_detected', 'Device Detected'), ('device_fingerprint_updated', 'Device Fingerprint Updated'), ('device_verification_initiated', 'Device Verification Initiated'), ('device_verification_completed', 'Device Verification Completed'), ('device_verification_failed', 'Device Verification Failed'), ('device_marked_trusted', 'Device Marked Trusted'), ('device_trust_revoked', 'Device Trust Revoked'), ('device_trust_expired', 'Device Trust Expired'), ('trusted_device_bypassed_mfa', 'Trusted Device Bypassed MFA'), ('device_removed', 'Device Removed'), ('device_unlinked', 'Device Unlinked'), ('device_soft_deleted', 'Device Soft Deleted'), ('device_hard_deleted', 'Device Hard Deleted'), ('suspicious_device_detected', 'Suspicious Device Detected'), ('device_compromise_suspected', 'Device Compromise Suspected'), ('device_location_anomaly', 'Device Location Anomaly'), ('multiple_devices_same_location', 'Multiple Devices Same Location'), ('device_name_changed', 'Device Name Changed'), ('device_metadata_updated', 'Device Metadata Updated'), ('device_permissions_updated', 'Device Permissions Updated')], max_length=50)),
                ('device_fingerprint', models.CharField(blank=True, max_length=255)),
                ('device_name', models.CharField(blank=True, max_length=255)),
                ('device_type', models.CharField(blank=True, choices=[('mobile', 'Mobile'), ('tablet', 'Tablet'), ('desktop', 'Desktop'), ('unknown', 'Unknown')], max_length=20)),
                ('browser', models.CharField(blank=True, max_length=100)),
                ('os', models.CharField(blank=True, max_length=100)),
                ('country', models.CharField(blank=True, max_length=100)),
                ('city', models.CharField(blank=True, max_length=100)),
                ('previous_country', models.CharField(blank=True, max_length=100)),
                ('previous_city', models.CharField(blank=True, max_length=100)),
                ('was_trusted', models.BooleanField(default=False)),
                ('now_trusted', models.BooleanField(default=False)),
                ('trust_duration_days', models.PositiveIntegerField(blank=True, null=True)),
                ('verification_method', models.CharField(blank=True, choices=[('email_otp', 'Email OTP'), ('sms_otp', 'SMS OTP'), ('manual', 'Manual'), ('auto', 'Automatic')], max_length=50)),
                ('risk_score', models.PositiveIntegerField(default=0)),
                ('risk_level', models.CharField(choices=[('low', 'Low'), ('medium', 'Medium'), ('high', 'High'), ('critical', 'Critical')], default='low', max_length=20)),
                ('is_anomalous', models.BooleanField(default=False)),
                ('anomaly_reasons', models.JSONField(blank=True, default=list)),
                ('action_taken', models.CharField(blank=True, max_length=255)),
                ('requires_review', models.BooleanField(default=False)),
                ('changed_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_made', to=settings.AUTH_USER_MODEL)),
                ('device', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='device_audits', to='devices.device')),
                ('session', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='device_audits', to='sessions.session')),
                ('user', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_logs', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Device Audit Log',
                'verbose_name_plural': 'Device Audit Logs',
                'db_table': 'device_audit_logs',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='AuditLogSummary',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('summary_date', models.DateField(db_index=True)),
                ('total_sessions_created', models.PositiveIntegerField(default=0)),
                ('total_sessions_terminated', models.PositiveIntegerField(default=0)),
                ('total_sessions_revoked', models.PositiveIntegerField(default=0)),
                ('concurrent_sessions_max', models.PositiveIntegerField(default=0)),
                ('total_devices_registered', models.PositiveIntegerField(default=0)),
                ('total_devices_verified', models.PositiveIntegerField(default=0)),
                ('total_devices_trusted', models.PositiveIntegerField(default=0)),
                ('total_devices_removed', models.PositiveIntegerField(default=0)),
                ('failed_mfa_attempts', models.PositiveIntegerField(default=0)),
                ('successful_mfa_verifications', models.PositiveIntegerField(default=0)),
                ('suspicious_activities_detected', models.PositiveIntegerField(default=0)),
                ('anomalous_devices_detected', models.PositiveIntegerField(default=0)),
                ('high_risk_events', models.PositiveIntegerField(default=0)),
                ('critical_risk_events', models.PositiveIntegerField(default=0)),
                ('unique_locations', models.PositiveIntegerField(default=0)),
                ('unique_countries', models.PositiveIntegerField(default=0)),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='audit_summaries', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Audit Log Summary',
                'verbose_name_plural': 'Audit Log Summaries',
                'db_table': 'audit_log_summaries',
                'ordering': ['-summary_date'],
            },
        ),
        migrations.CreateModel(
            name='AuditLog',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('event_type', models.CharField(choices=[('login_success', 'Login Success'), ('login_failed', 'Login Failed'), ('logout', 'Logout'), ('session_expired', 'Session Expired'), ('account_created', 'Account Created'), ('account_updated', 'Account Updated'), ('account_deleted', 'Account Deleted'), ('email_changed', 'Email Changed'), ('email_verified', 'Email Verified'), ('phone_changed', 'Phone Changed'), ('password_changed', 'Password Changed'), ('password_reset_requested', 'Password Reset Requested'), ('password_reset_completed', 'Password Reset Completed'), ('password_failed_attempts', 'Password Failed Attempts'), ('mfa_enabled', 'MFA Enabled'), ('mfa_disabled', 'MFA Disabled'), ('mfa_method_added', 'MFA Method Added'), ('mfa_method_removed', 'MFA Method Removed'), ('device_added', 'Device Added'), ('device_removed', 'Device Removed'), ('device_verified', 'Device Verified'), ('device_trusted', 'Device Trusted'), ('device_compromised', 'Device Compromised')], db_index=True, max_length=50)),
                ('severity', models.CharField(choices=[('low', 'Low'), ('medium', 'Medium'), ('high', 'High'), ('critical', 'Critical')], db_index=True, max_length=20)),
                ('description', models.TextField()),
                ('ip_address', models.GenericIPAddressField(blank=True, null=True)),
                ('user_agent', models.TextField(blank=True)),
                ('metadata', models.JSONField(blank=True, default=dict)),
                ('is_resolved', models.BooleanField(default=False)),
                ('resolved_at', models.DateTimeField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('device', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='generic_audits', to='devices.device')),
                ('resolved_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='resolved_audit_logs', to=settings.AUTH_USER_MODEL)),
                ('user', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='audit_logs', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Audit Log',
                'verbose_name_plural': 'Audit Logs',
                'db_table': 'audit_logs',
                'ordering': ['-created_at'],
            },
        ),
        migrations.AddIndex(
            model_name='sessiondevicelinkauditlog',
            index=models.Index(fields=['user', '-created_at'], name='session_dev_user_id_5b4343_idx'),
        ),
        migrations.AddIndex(
            model_name='sessiondevicelinkauditlog',
            index=models.Index(fields=['session', '-created_at'], name='session_dev_session_c81345_idx'),
        ),
        migrations.AddIndex(
            model_name='sessiondevicelinkauditlog',
            index=models.Index(fields=['device', '-created_at'], name='session_dev_device__3089cf_idx'),
        ),
        migrations.AddIndex(
            model_name='sessionauditlog',
            index=models.Index(fields=['user', 'action', '-created_at'], name='session_aud_user_id_3c3947_idx'),
        ),
        migrations.AddIndex(
            model_name='sessionauditlog',
            index=models.Index(fields=['session', '-created_at'], name='session_aud_session_c40568_idx'),
        ),
        migrations.AddIndex(
            model_name='sessionauditlog',
            index=models.Index(fields=['device', '-created_at'], name='session_aud_device__25f5d0_idx'),
        ),
        migrations.AddIndex(
            model_name='sessionauditlog',
            index=models.Index(fields=['risk_level', '-created_at'], name='session_aud_risk_le_4acaa7_idx'),
        ),
        migrations.AddIndex(
            model_name='mfachangelog',
            index=models.Index(fields=['user', '-created_at'], name='mfa_change__user_id_011b30_idx'),
        ),
        migrations.AddIndex(
            model_name='mfachangelog',
            index=models.Index(fields=['change_type', '-created_at'], name='mfa_change__change__662149_idx'),
        ),
        migrations.AddIndex(
            model_name='mfaauditlog',
            index=models.Index(fields=['user', 'action', '-created_at'], name='mfa_audit_l_user_id_77053d_idx'),
        ),
        migrations.AddIndex(
            model_name='mfaauditlog',
            index=models.Index(fields=['mfa_method', '-created_at'], name='mfa_audit_l_mfa_met_40d53d_idx'),
        ),
        migrations.AddIndex(
            model_name='mfaauditlog',
            index=models.Index(fields=['risk_level', '-created_at'], name='mfa_audit_l_risk_le_ecc34c_idx'),
        ),
        migrations.AddIndex(
            model_name='deviceauditlog',
            index=models.Index(fields=['user', 'action', '-created_at'], name='device_audi_user_id_88e5b4_idx'),
        ),
        migrations.AddIndex(
            model_name='deviceauditlog',
            index=models.Index(fields=['device', '-created_at'], name='device_audi_device__a5f5e5_idx'),
        ),
        migrations.AddIndex(
            model_name='deviceauditlog',
            index=models.Index(fields=['risk_level', '-created_at'], name='device_audi_risk_le_5b15e1_idx'),
        ),
        migrations.AddIndex(
            model_name='deviceauditlog',
            index=models.Index(fields=['is_anomalous', '-created_at'], name='device_audi_is_anom_d6f2a9_idx'),
        ),
        migrations.AddIndex(
            model_name='auditlogsummary',
            index=models.Index(fields=['user', 'summary_date'], name='audit_log_s_user_id_9734da_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='auditlogsummary',
            unique_together={('user', 'summary_date')},
        ),
        migrations.AddIndex(
            model_name='auditlog',
            index=models.Index(fields=['user', 'event_type', '-created_at'], name='audit_logs_user_id_1007ab_idx'),
        ),
        migrations.AddIndex(
            model_name='auditlog',
            index=models.Index(fields=['event_type', '-created_at'], name='audit_logs_event_t_d2baa2_idx'),
        ),
        migrations.AddIndex(
            model_name='auditlog',
            index=models.Index(fields=['severity', '-created_at'], name='audit_logs_severit_a4af98_idx'),
        ),
        migrations.AddIndex(
            model_name='auditlog',
            index=models.Index(fields=['-created_at'], name='audit_logs_created_43fcd6_idx'),
        ),
    ]
